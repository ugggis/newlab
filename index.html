<script>
    const scriptURL = "https://script.google.com/macros/s/AKfycbzXEV_vGHBDA2IJaLBurCGZU0xkMmrL7igdk_wAMgCwcdJ0DVuHB6_8SSaJ6L07pLSZ/exec";
    
    function saveTable() {
        const rows = [...taskTable.rows].map(row => ({
            task: row.cells[0].innerText,
            student: row.cells[1].innerText,
            date: row.cells[2].querySelector("select").value,
            notes: row.cells[3].innerText
        }));
        fetch(scriptURL, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(rows)
        })
        .then(response => response.text())
        .then(data => {
            alert(data); // Show response from server
        });
    }

    function loadTable() {
        fetch(scriptURL)
        .then(response => response.json())
        .then(data => {
            taskTable.innerHTML = "";
            data.slice(1).forEach(row => addRow(row[0], row[1], row[2], row[3])); // Skip header row
        });
    }
</script>
